<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Fracking infomaze</title>
    <meta name="description" content="Fracing Infomaze">
    <meta name="author" content="Sophie KS">

    <script type="text/javascript" src="//use.typekit.net/dpf6sra.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript">
            window.isDoneLoading = false;
var html5Preloader = (function () {

var XHR = typeof XMLHttpRequest === 'undefined' ? function () { // IE FIX
        try {
            return new ActiveXObject("Msxml2.XMLHTTP.6.0");
        } catch (err1) {}
        try {
            return new ActiveXObject("Msxml2.XMLHTTP.3.0");
        } catch (err2) {}

        return null;
    } : XMLHttpRequest,
    AudioElement = typeof Audio !== 'undefined' ? // IE FIX
        function(){
            return new Audio();
        } :
        function(){
            return document.createElement('audio');
        },
    VideoElement = typeof Video !== 'undefined' ? // IE FIX
        function () {
            return new Video();
        } :
        function () {
            return document.createElement('video');
        },
    ImageElement = function () {
        return new Image();
    },
    codecs = { // Chart from jPlayer
        oga: { // OGG
            codec: 'audio/ogg; codecs="vorbis"',
            media: 'audio'
        },
        wav: { // PCM
            codec: 'audio/wav; codecs="1"',
            media: 'audio'
        },
        webma: { // WEBM
            codec: 'audio/webm; codecs="vorbis"',
            media: 'audio'
        },
        mp3: {
            codec: 'audio/mpeg; codecs="mp3"',
            media: 'audio'
        },
        m4a: { // AAC / MP4
            codec: 'audio/mp4; codecs="mp4a.40.2"',
            media: 'audio'
        },
        ogv: { // OGG
            codec: 'video/ogg; codecs="theora, vorbis"',
            media: 'video'
        },
        webmv: { // WEBM
            codec: 'video/webm; codecs="vorbis, vp8"',
            media: 'video'
        },
        m4v: { // H.264 / MP4
            codec: 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',
            media: 'video'
        }
    },
    support = {
        imageTypes: ['jpg', 'png', 'jpeg', 'tiff', 'gif']
    },
    ID_PREFIX = 'FILE@';
/* :) may fail sometimes, but these are the most common cases */
codecs.ogg = codecs.oga;
codecs.mp4 = codecs.m4v;
codecs.webm = codecs.webmv;

function isIn (needle, haystack) {
    for (var i=0; i<haystack.length; i++) {
        if (haystack[i] === needle) {
            return true;
        }
    }

    return false;
}

function map (arr, callback) {
    if (arr.map) {
        return arr.map(callback);
    }

    var r = [],
        i;
    for (i=0; i<arr.length; i++) {
        r.push(callback(arr[i]));
    }

    return r;
}

function bind (func, self) {
    return func.bind ? func.bind(self) : function () {
        return func.apply(self, arguments);
    };
}

function delay (callback) {
    var args = [].slice.call(arguments, 1);
    setTimeout(function () {
        callback.apply(this, args);
    }, 0);
}

function EventEmitter () {
    var k;
    for (k in EventEmitter.prototype) {
        if (EventEmitter.prototype.hasOwnProperty(k)) {
            this[k] = EventEmitter.prototype[k];
        }
    }
    this._listeners = {};
};

EventEmitter.prototype = {
    _listeners: null,

    emit: function (name, args) {
        args = args || [];
        if (this._listeners[name]) {
            for (var i=0; i<this._listeners[name].length; i++) {
                this._listeners[name][i].apply(this, args);
            }
        }
        return this;
    },

    on: function (name, listener) {
        this._listeners[name] = this._listeners[name] || [];
        this._listeners[name].push(listener);
        return this;
    },

    off: function (name, listener) {
        if (this._listeners[name]) {
            if (!listener) {
                delete this._listeners[name];
                return this;
            }
            for (var i=0; i<this._listeners[name].length; i++) {
                if (this._listeners[name][i] === listener) {
                    this._listeners[name].splice(i--, 1);
                }
            }
            this._listeners[name].length || delete this._listeners[name];
        }
        return this;
    },

    once: function (name, listener) {
        function ev () {
            this.off(ev);
            return listener.apply(this, arguments);
        }

        return this.on(name, ev);
    }
};

function loadFile (file, callback, timeout) {
    if (!(this instanceof loadFile)) {
        return new loadFile(file, callback, timeout);
    }

    var self        = this,
        alternates  = [],
        a, b, c, t;

    if (typeof file === 'string') {
        a = file.split('*:');
        b = a[ a[1] ? 1 : 0 ].split('||');
        self.id = a[1] ? a[0] : b[0];
        self.alternates = alternates;

        for (a=0; a<b.length; a++) {
            c = b[a].split('.');
            c = c[c.length - 1].toLowerCase();

            t = codecs[c] ? codecs[c].media : isIn(c, support.imageTypes) ? 'image' : 'document';

            if (codecs[c] && !codecs[c].supported) {
                continue;
            }

            alternates.push({
                type: t,
                path: b[a]
            });
        }

        alternates.length || alternates.push({
            type: t,
            path: b[a-1]
        });
    } else {
        delay(callback, TypeError('Invalid path'), self);
        return;
    }

    function loadNext() {
        var file = alternates.shift(),
            _timeoutTimer = null;

        if (!file) {
            delay(callback, {e: Error('No viable alternatives')}, null);
            return;
        }

        if (typeof timeout === 'number') {
            _timeoutTimer = setTimeout(function() {
                delay(callback, {e: Error('Load event not fired within ' + timeout + 'ms')}, self);
            }, timeout);
        }

        new loadFile[file.type](
                file.path,
                function (e, f) {

                    _timeoutTimer && clearTimeout(_timeoutTimer);

                    self.dom = f && f.dom;

                    if (e && self.alternates.length) {
                        return loadNext();
                    }

                    callback(e, self);
                });
    }

    loadNext();
}

function MediaFile (construct) {
    return function (filename, callback) {
        var self = this,
            file = construct();

        function onready () {
            file.onload = file.onerror = null;
            file.removeEventListener && file.removeEventListener('canplaythrough', onready, true);

            callback(null, self);
        }

        file.addEventListener && file.addEventListener('canplaythrough', onready, true);
        file.onload = onready;
        file.onerror = function (e) {
            callback(e, self);
        };

        self.dom = file;
        file.src = filename;

        file.load && file.load();
    };
}

loadFile.audio = MediaFile(AudioElement);
loadFile.video = MediaFile(VideoElement);
loadFile.image = MediaFile(ImageElement);

loadFile.document = function (file, callback) {
    var self        = this,
        parsedUrl   = /(\[(!)?(.+)?\])?$/.exec(file),
        mimeType    = parsedUrl[3],
        xhr     = self.dom = new XHR();

    if (!xhr) {
        delay(callback, Error('No XHR!'), self);
        return;
    }

    file        = file.substr(0, file.length - parsedUrl[0].length);
    file        += parsedUrl[2] ? (file.indexOf('?') === -1 ? '?' : '&') + 'fobarz=' + (+new Date) : '';

    mimeType && xhr.overrideMimeType(mimeType === '@' ? 'text/plain; charset=x-user-defined' : mimeType);

    xhr.onreadystatechange = function () {
        if (xhr.readyState !== 4) return;

        try {
            self.dom = xhr.responseXML && xhr.responseXML.documentElement ?
                xhr.responseXML :
                String(xhr.responseText || '') ;

            xhr.status === 200 ?
                callback(null, self) :
                callback({e: Error('Request failed: ' + xhr.status)}, self) ;
        } catch (e) {
            callback({e: e}, self);
        }
    };

    xhr.onerror = function (e) {
        callback(e, self);
    };

    xhr.open('GET', file, true);
    xhr.send();
};

(function () {
    var     dummyAudio = AudioElement(),
        dummyVideo = VideoElement(),
        i;

    support.audio = !!dummyAudio.canPlayType;
    support.video = !!dummyVideo.canPlayType;

    support.audioTypes = [];
    support.videoTypes = [];

    for (i in codecs) {
        if (codecs.hasOwnProperty(i)) {
            if (codecs[i].media === 'video') {
                (codecs[i].supported = support.video &&
                    dummyVideo.canPlayType(codecs[i].codec)) &&
                    support.videoTypes.push(i);
            } else if (codecs[i].media === 'audio') {
                (codecs[i].supported = support.audio &&
                    dummyAudio.canPlayType(codecs[i].codec)) &&
                    support.audioTypes.push(i);
            }
        }
    }
}());

if (!support.audio) {
    loadFile.audio = function (a, callback) {
        delay(callback, Error('<AUDIO> not supported.'), a);
    };
}
if (!support.video) {
    loadFile.video = function (a, callback) {
        delay(callback, Error('<VIDEO> not supported.'), a);
    };
}

function html5Preloader () {
    var self = this,
        args = arguments;

    if (!(self instanceof html5Preloader)) {
        self = new html5Preloader();
        args.length && self.loadFiles.apply(self, args);
        return self;
    }

    self.files = [];

    html5Preloader.EventEmitter.call(self);

    self.loadCallback = bind(self.loadCallback, self);

    args.length && self.loadFiles.apply(self, args);
}

html5Preloader.prototype = {
    active: false,
    files: null,
    filesLoading: 0,
    filesLoaded: 0,
    filesLoadedMap: {},
    timeout: null,

    loadCallback: function (e, f) {

        if (!this.filesLoadedMap[f.id]) {
            this.filesLoaded++;
            this.filesLoadedMap[f.id] = f;
        }

        this.emit(e ? 'error' : 'fileloaded', e ? [e, f] : [f]);

        if (this.filesLoading - this.filesLoaded === 0) {
            this.active = false;
            this.emit('finish');
            this.filesLoading = 0;
            this.filesLoaded = 0;
        }
    },

    getFile: function (id) {
        return  typeof id === 'undefined' ? map(this.files, function (f) {
                return f.dom;
            }) :
            typeof id === 'number' ? this.files[id].dom :
            typeof id === 'string' ? this.files[ID_PREFIX + id].dom :
            null;
    },

    removeFile: function (id) {
        var f, i;
        switch (typeof id) {
        case 'undefined':
            this.files = [];
            break;
        case 'number':
            f = this.files[id];
            this.files[ID_PREFIX + f.id] && delete this.files[ID_PREFIX + f.id];
            this.files.splice(id, 1);
            break;
        case 'string':
            f = this.files[ID_PREFIX + id];
            f && delete this.files[ID_PREFIX + id];

            for (i=0; i<this.files.length; i++) {
                this.files[i] === f && this.files.splice(i--, 1);
            }
        }
    },

    loadFiles: function () {
        var files   = [].slice.call(arguments),
            i, f;

        for (i=0; i<files.length; i++) {
            f = html5Preloader.loadFile(files[i], this.loadCallback, this.timeout);
            this.files.push(f);
            this.files[ID_PREFIX + f.id] = f;
            this.filesLoading++;
        }

        this.active = this.active || !!this.filesLoading;
    },

    addFiles: function (list) {
        return this.loadFiles.apply(this, list instanceof Array ? list : arguments);
    },

    getProgress: function () {
        return this.filesLoading ? this.filesLoaded / this.filesLoading : 1.0;
    }
};

html5Preloader.support = support;
html5Preloader.loadFile = loadFile;
html5Preloader.EventEmitter = EventEmitter;

return html5Preloader;

}());
    </script>
    <script type="text/javascript">
        var loader = html5Preloader();
        loader.addFiles('images/1.jpg', 'images/10.gif', 'images/10.jpg', 'images/10a.jpg', 'images/10aa.jpg', 'images/10b.gif', 'images/10b.jpg', 'images/10c.gif', 'images/10c.jpg', 'images/11.gif', 'images/11.jpg', 'images/11a.jpg', 'images/11aa.gif', 'images/11aa.jpg', 'images/11b.jpg', 'images/11c.gif', 'images/11c.jpg', 'images/12.gif', 'images/12.jpg', 'images/12a.jpg', 'images/12aa.gif', 'images/12aa.jpg', 'images/12c.gif', 'images/12c.jpg', 'images/13.jpg', 'images/13a.jpg', 'images/13aa.jpg', 'images/13c.gif', 'images/13c.jpg', 'images/14.jpg', 'images/14a.gif', 'images/14aa.gif', 'images/15a.jpg', 'images/15aa.jpg', 'images/16.jpg', 'images/16a.jpg', 'images/16aa.jpg', 'images/16b.gif', 'images/16c.jpg', 'images/17a.jpg', 'images/17aa.gif', 'images/17aa_last.jpg', 'images/17b.jpg', 'images/18.jpg', 'images/18a.gif', 'images/18aa.gif', 'images/19.jpg', 'images/19a.jpg', 'images/19aa.jpg', 'images/19b.jpg', 'images/19c.jpg', 'images/19d.jpg', 'images/19e.jpg', 'images/19f.gif', 'images/19f.jpg', 'images/1a.gif', 'images/2.jpg', 'images/20.jpg', 'images/20a.jpg', 'images/20aa.jpg', 'images/20bb.jpg', 'images/20d.jpg', 'images/20e.jpg', 'images/20gg.jpg', 'images/20hh.jpg', 'images/20ii.jpg', 'images/20jj.jpg', 'images/21.jpg', 'images/21a.jpg', 'images/21aa.gif', 'images/21aa.jpg', 'images/21bb.jpg', 'images/21cc.jpg', 'images/21d.jpg', 'images/21dd.jpg', 'images/21ee.jpg', 'images/21f.jpg', 'images/21ff.jpg', 'images/21gg.gif', 'images/21gg.jpg', 'images/21hh.gif', 'images/21hh.jpg', 'images/22.jpg', 'images/22a.jpg', 'images/22aa.jpg', 'images/22bb.jpg', 'images/22f.jpg', 'images/23.gif', 'images/23.jpg', 'images/23a.jpg', 'images/23aa.jpg', 'images/23b.jpg', 'images/23bb.jpg', 'images/23c.jpg', 'images/23cc.jpg', 'images/23d.jpg', 'images/23f.jpg', 'images/23ff.jpg', 'images/23g.jpg', 'images/23gg.jpg', 'images/23hh.jpg', 'images/24.jpg', 'images/24a.jpg', 'images/24aa.jpg', 'images/24b.jpg', 'images/24c.jpg', 'images/24d.jpg', 'images/24e.jpg', 'images/24ee.jpg', 'images/24f.jpg', 'images/24ff.jpg', 'images/24g.jpg', 'images/24h.jpg', 'images/24hh.jpg', 'images/24i.jpg', 'images/24ii.jpg', 'images/25.jpg', 'images/25a.jpg', 'images/25aa.jpg', 'images/25b.jpg', 'images/25bb.jpg', 'images/25c.jpg', 'images/25cc.jpg', 'images/25d.jpg', 'images/25dd.jpg', 'images/25e.jpg', 'images/25ee.jpg', 'images/25ff.jpg', 'images/25g.jpg', 'images/25gg.jpg', 'images/25h.jpg', 'images/25hh.jpg', 'images/25ii.gif', 'images/25ii.jpg', 'images/25jj.jpg', 'images/25kk.jpg', 'images/26.jpg', 'images/26a.jpg', 'images/26aa.jpg', 'images/26b.jpg', 'images/26c.jpg', 'images/26cc.jpg', 'images/26d.jpg', 'images/26e.jpg', 'images/26ee.jpg', 'images/26ff.jpg', 'images/26g.jpg', 'images/26gg.gif', 'images/26gg.jpg', 'images/26h.jpg', 'images/26hh.jpg', 'images/27.jpg', 'images/27a.jpg', 'images/27aa.jpg', 'images/27b.jpg', 'images/27c.jpg', 'images/27cc.gif', 'images/27cc.jpg', 'images/27e.jpg', 'images/27ee.jpg', 'images/27gg.jpg', 'images/27hh.jpg', 'images/28.jpg', 'images/28a.jpg', 'images/28aa.jpg', 'images/28b.jpg', 'images/28bb.gif', 'images/28bb.jpg', 'images/28c.jpg', 'images/28cc.gif', 'images/28cc.jpg', 'images/28dd.jpg', 'images/28ee.jpg', 'images/29.jpg', 'images/29aa.gif', 'images/29aa.jpg', 'images/29bb.jpg', 'images/29cc.jpg', 'images/29dd.gif', 'images/29dd.jpg', 'images/2a.jpg', 'images/3.jpg', 'images/30cc.jpg', 'images/30dd.jpg', 'images/31cc.jpg', 'images/32cc.jpg', 'images/33cc.jpg', 'images/34cc.jpg', 'images/3a.jpg', 'images/4.jpg', 'images/4a.jpg', 'images/4aa.jpg', 'images/5.jpg', 'images/5a.jpg', 'images/5aa.gif', 'images/6.jpg', 'images/6a.jpg', 'images/6aa.jpg', 'images/7.jpg', 'images/7a.jpg', 'images/7aa.jpg', 'images/7b.jpg', 'images/7c.jpg', 'images/7d.jpg', 'images/8.jpg', 'images/8a.gif', 'images/8aa.gif', 'images/8b.gif', 'images/9.jpg', 'images/9a.jpg', 'images/9aa.jpg', 'images/9b.jpg', 'images/minimap.png');
    </script>

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script id="bootstrap" type="text/javascript" charset="utf-8"
            src="bootstrap.js"></script>

    <style type="text/css" media="screen">
        body, html { height: 100%; }
        #screen {
            position: fixed;
            height: 100%;
            width: 100%;
            background: #e4f3fa;
            top: 0;
            left: 0;
            z-index: 100000;
        }

        #loading {
            font-weight: 900;
            font-size: 78px;
            position: absolute;
            width: 850px;
            height: 150px;
            line-height: 150px;
            text-align: center;
            top: 50%;
            left: 50%;
            margin: -100px 0 0 -385px;
            letter-spacing: 0.600em;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div id="screen">
        <div id="loading" class="tk-futura-pt">Loading</div>
    </div>
    <div id="wrapper">
        <div id="cell">
            <div id="viewport-container">
                <h1 class="tk-futura-pt">INFOMAZE</h1>
                <h2 id="open">Map</h2>
                <h2 id="close-external">Close</h2>
                <div id="minimap-viewport">
                    <div id="minimap">
                        <div id="close">&times;</div>
                        <div id="star"></div>
                        <div id="yah">
                            <div class="dot"></div>
                            <div class="pulse"></div>
                        </div>
                    </div>
                </div>
                <component id="main-application"></component>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        loader.on('finish', function(){
            if (window.jQuery && window.jQuery("#screen")) {
                $("#screen").fadeOut("fast");
            } else {
                window.isDoneLoading = true;
            }
        });
        loader.on('error', function(e){ console.error(e); });
    </script>
</body>
</html>

